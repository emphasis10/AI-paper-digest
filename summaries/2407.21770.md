# MoMa: Efficient Early-Fusion Pre-training with Mixture of Modality-Aware Experts
## TL;DR
## Summary
- [https://arxiv.org/pdf/2407.21770.pdf](https://arxiv.org/pdf/2407.21770.pdf)

## 1. 논문 각 섹션 요약

### 1.1 서론
서론에서는 혼합 모달리티 입력을 처리하고 출력하는 자가회귀 혼합 모달리티 모델의 중요성을 강조합니다. 현재의 모델들은 비주얼 질문 응답, 혼합 모달리티 콘텐츠 생성 등 다양한 작업에서 뛰어난 성능을 보이고 있지만, 이러한 모델들을 더 높은 용량으로 확장하는 데 있어 큰 계산적 도전 과제가 존재한다고 언급합니다.

### 1.2 문헌 검토
기존의 혼합 모달리티 모델들의 한계를 극복하기 위해, 텍스트와 이미지 토큰의 이질성을 더 잘 포착할 수 있는 전문가 믹스 (Mixture of Experts, MoE) 아키텍처를 제안합니다. 이전 연구들에서는 주로 비전 및 언어 인코더와 마스크드 언어 모델에 MoE를 적용했으나, 본 논문에서는 이를 조기 융합 혼합 모달리티 언어 모델에 적용합니다.

### 1.3 방법론
MoE를 도입하여 폭과 깊이 두 차원에서 희소성을 구현합니다. 폭에서는 토큰을 텍스트 및 이미지 전문가 그룹으로 라우팅하고, 깊이에서는 특정 레이어의 계산을 건너뛰는 방식을 채택합니다. 이를 통해 학습 속도가 크게 향상됩니다.

### 1.4 결과 및 분석
실험 결과, 제안된 Chameleon-MoMa 아키텍처가 프리트레이닝 손실 기준으로 최대 3.7배의 FLOP(부동소수점 연산) 감소를 보여주었습니다. 이는 동일한 조건에서 MoE 모델보다 약간 더 나은 성능을 나타냅니다. 그러나, 깊이 희소성을 추가한 경우에는 다소 성능 저하가 발생하여, 이러한 접근 방식의 효과적인 조합에는 추가 연구가 필요합니다.

### 1.5 논의
현재 구현에서 발생하는 부하 불균형 문제와 자동 회귀 언어 모델에서의 성능 저하 문제를 해결해야 할 필요성을 강조합니다. 특히, 다양한 데이터 분포에서의 일반화 성능을 보장하기 위해 추가 연구가 필요합니다.

### 1.6 결론
본 논문은 조기 융합 혼합 모달리티 모델을 위한 모달리티 인식 희소 아키텍처를 제안합니다. 제안된 Chameleon-MoMa 모델은 현재의 최첨단 기준을 초과하는 성능을 보이며, 혼합 모달리티 모델 훈련의 효율성을 크게 향상시킵니다. 앞으로 더 복잡한 라우팅 메커니즘과 다양한 모달리티 및 작업에 대한 연구가 필요합니다.

## 2. 전체 요약
본 논문은 혼합 모달리티 입력을 처리하고 출력하는 자가회귀 언어 모델의 효율성을 개선하기 위해 모달리티 인식 전문가 믹스(Mixture of Modality-Aware Experts, MoMa) 아키텍처를 제안합니다. 이는 텍스트와 이미지 토큰을 별도의 전문가 그룹으로 라우팅하여 전문화된 처리를 가능하게 합니다. 제안된 모델은 프리트레이닝 과정에서 최대 3.7배의 계산 효율성을 보이며, 다양한 다운스트림 작업에서 뛰어난 성능을 보입니다. 그러나, 자동 회귀 추론 성능의 손실 문제를 해결하기 위해 추가 연구가 필요합니다. 본 논문의 주요 기여는 모달리티 인식 희소 아키텍처의 도입과 이를 통한 혼합 모달리티 모델 훈련 효율성의 극대화에 있습니다.

## Similar Papers
- [Lory: Fully Differentiable Mixture-of-Experts for Autoregressive Language Model Pre-training](2405.03133.md)
- [Nearest Neighbor Speculative Decoding for LLM Generation and Attribution](2405.19325.md)
- [Transformers Can Do Arithmetic with the Right Embeddings](2405.17399.md)
- [ConvLLaVA: Hierarchical Backbones as Visual Encoder for Large Multimodal Models](2405.15738.md)
- [NeMo-Aligner: Scalable Toolkit for Efficient Model Alignment](2405.01481.md)
- [Chameleon: Mixed-Modal Early-Fusion Foundation Models](2405.09818.md)
- [Yuan 2.0-M32: Mixture of Experts with Attention Router](2405.17976.md)
- [Video Occupancy Models](2407.09533.md)
- [Self-MoE: Towards Compositional Large Language Models with Self-Specialized Experts](2406.12034.md)
