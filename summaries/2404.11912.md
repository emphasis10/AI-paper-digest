# TriForce: Lossless Acceleration of Long Sequence Generation with Hierarchical Speculative Decoding
## TL;DR
## Summary
- [https://arxiv.org/pdf/2404.11912.pdf](https://arxiv.org/pdf/2404.11912.pdf)


### 1. TriForce의 주요 기여 및 혁신
- **TriForce 시스템 도입**: KV(key-value) 캐시의 부담을 효율적으로 줄이는 계층적 추측 해석 기술을 적용하여, 긴 시퀀스 생성을 위한 체계적인 접근방식을 제공합니다.
- **속도 및 확장성 향상**: Llama2-7B-128K 모델에서 A100 GPU상에서 최대 2.31배, RTX 4090 GPU에서 4.86배의 속도 향상을 달성함으로써, 긴 문맥 처리에 대한 확장성을 입증했습니다.
- **계층적 추측 및 인출 기반 초안 모델** : 원본 모델 가중치와 동적인 희소 KV 캐시를 이용하여, 초안 모델을 더 작은 모델로 추측하여 초안 작성의 지연 시간을 줄입니다. 이는 메모리 병목 현상을 효과적으로 해결하며 긴 시퀀스 생성의 효율성을 높입니다.

### 2. 섹션별 주요 내용 요약

#### 1) 서론
- **문제 인식**: LLMs의 자동 회귀적 특성으로 인해, 생성할 때마다 전체 KV 캐시를 로드해야 하며, 이는 계산 코어의 활용도 저하 및 높은 지연 시간을 초래합니다.
- **기여 도입**: TriForce는 이러한 문제를 해결하기 위해 다양한 압축 방법과 병행하여 그 장애물을 극복하는 새로운 접근방식을 소개합니다.

#### 2) TriForce 시스템 설계
- **계층적 추측 접근방식**: 모델 가중치와 KV 캐시의 두 가지 메모리 병목 현상을 해결하기 위해 계층적 추측을 적용합니다.
- **선택적 KV 캐시 사용**: 전체 캐시를 유지하면서 필요한 KV 쌍만 선택적으로 사용하여 처리 효율성을 극대화합니다.

### 3. 전반적인 요약
TriForce는 긴 시퀀스 생성을 위한 대규모 언어 모델(Large Language Models)의 효율적인 실행을 지원하는 혁신적인 시스템입니다. 이는 KV 캐시의 크기와 관련된 메모리 병목 현상을 줄이는 데 중점을 두고, 계층적 추측과 인출 기반 초안 모델을 통해 성능 저하 없이 속도와 확장성을 크게 향상시킵니다. 이 연구는 AI 및 머신러닝 분야에서 긴 문맥 생성의 효율성과 실용성을 개선하는 데 중요한 기여를 합니다.
