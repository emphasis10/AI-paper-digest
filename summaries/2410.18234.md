# Multi-Draft Speculative Sampling: Canonical Architectures and Theoretical Limits
## TL;DR
## Summary
- [https://arxiv.org/pdf/2410.18234.pdf](https://arxiv.org/pdf/2410.18234.pdf)

### 1. 도입 및 주요 공헌
- **목적:** 논문은 다중 초안 추론(다중 드래프트 추론) 방식을 탐구하며, 이로 인해 동일한 목표 모델의 분포와 일치하는 출력 토큰을 생성하는 방법에 대해 논의합니다.
- **주요 공헌:**
  1. 중요 샘플링(Importance Sampling)을 활용하는 새로운 토큰 선택 시스템을 제안하여 최적의 수용 확률을 달성합니다. 
  2. 두 개의 동일한 초안 모델(K=2)에서 수용 확률의 수학적 표현식을 제공하며, 수용 확률이 1이 되기 위한 필요 충분 조건을 제시합니다.
  3. 보다 빠른 구현을 위해 계산을 줄이면서도 수용 확률을 유지하는 휴리스틱 방법을 제시합니다.

### 2. 배경 및 관련 연구
- **LLM 추론 가속화:** LLM 추론의 본질적인 순차성과 메모리 제약을 극복하기 위해 몇 가지 방법이 제안되었습니다. 특히, 손실 없는 LLM 추론 가속화를 위해 제안된 '스페큘레이티브 디코딩'(Speculative Decoding)은 주목할 만한 대안으로 자리잡았습니다.

### 3. 이론 분석: 토큰 레벨 최적화 초안 선택
- **최적의 수용 확률:** 최적의 토큰 선택 규칙(TLSR)을 통해 수용 확률을 극대화하는 문제를 제기합니다. 이 문제를 선형 프로그램의 틀로 해결할 수 있음을 보여줍니다.

### 4. 중요 샘플링 기반의 빠른 추론
- **효율 개선:** 높은 확률 토큰 집합(top-k 또는 top-p)을 활용하여 계산 효율을 높이는 방안을 제시하고 이를 통해 출력의 일관성을 유지합니다.

### 5. 실험 결과
- **성능 비교:** 제안한 방법이 동일한 드래프트 모델을 사용하는 기존 방법들과 비교하여 블록 효율성 및 토큰 비율에서 눈에 띄는 개선을 가져옴을 실험을 통해 입증하였습니다.

### 6. 결론
- **다중 초안 추론:** 논문 결과는 두 개의 초안 모델(K = 2)의 경우 수용 확률에 대한 명시적 수학적 표현을 제공하며, 이론 분석을 바탕으로 중요 샘플링에 기반한 새로운 토큰 선택 체계를 제안하였습니다.

---

### 전체 요약
이 논문은 AI의 효율적인 활용을 촉진하기 위한 다중 초안 추론 체계를 다루고 있습니다. 제안된 방법론은 특히 높은 성능의 LLM을 순차적 제약에서 벗어나게 하고, 토큰 수용 확률을 극대화함으로써 효율성을 높이는 데 중점을 두고 있습니다. 이는 추후 AI의 실용적인 응용과 발전에 크게 기여할 수 있을 것입니다. 

본 요약을 바탕으로 다양한 AI 응용 프로그램에 있어서 추론을 효과적으로 가속화할 수 있는 방안을 계획할 수 있을 것입니다.