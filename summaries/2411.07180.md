# Counterfactual Generation from Language Models
## TL;DR
## Summary
- [https://arxiv.org/pdf/2411.07180.pdf](https://arxiv.org/pdf/2411.07180.pdf)

### 1. 서론
이 논문은 언어 모델(Language Model, LM)의 해석성과 관련된 연구들을 Pearl의 인과 추론 논리로 탐구하고 있습니다. 주로 언어 모델의 매개변수를 조작하고, '만약'의 조건을 통해 문자열을 생성하는 역인과적 샘플링에 대해 설명하고 있습니다.

### 2. 언어 모델을 일반화된 구조방정식모델(GSEM)로 변환
언어 모델을 GSEM으로 변환하는 방법을 설명합니다. 이 방법은 기존의 확률적 모델을 Gumbel-max 트릭을 적용하여 구조방정식모델로 변환시켜 인과적 추론을 가능하게 합니다. 이는 언어 모델의 상징적 생성 과정을 보다 명확히 이해하게 도와줍니다.

### 3. 반사실적 생성
GSEM을 통해 주어진 문자열의 반사실적 문자열을 생성할 수 있는 방법을 제안합니다. 이는 기존의 매개변수와 비슷한 노이즈를 이용하여 인과 관계를 분석할 수 있는 도구로 활용됩니다. 또한, 반사실적 문자열 생성의 알고리즘을 제공하여 언어 모델의 구체적인 행위를 예측할 수 있도록 합니다.

### 4. 실험 및 결과
논문은 다양한 개입 기술을 활용하여 GPT2-XL 및 LLaMA3-8b 모델에서 반사실적 문자열을 생성하는 실험을 진행하였습니다. 이러한 개입은 모델의 특정 지식을 수정하거나 행동을 정확하게 변화시키고자 하였으나, 종종 원치 않는 부작용을 초래함을 보였습니다. 성별에 대한 개입은 예기치 않게 관계없는 텍스트의 완성에 영향을 미치는 예를 들고 있습니다.

### 논문의 주요 기여와 혁신적인 부분
논문은 언어 모델을 GSEM으로 변환하여 인과적 추론을 할 수 있는 새로운 프레임워크를 제공합니다. 이를 통해 모델의 매개변수 변화와 인과 관계에 대한 명확한 이해를 가능케 하며 이를 통해 반사실적 샘플링을 가능하게 했습니다.

### 전반적인 요약
이 논문은 언어 모델의 내적 작동 방식을 탐구하고, 이를 인과적 관점에서 해석할 수 있는 새로운 방법론을 제시합니다. 이는 모델의 매개변수에 대한 조작이 자연어 처리 작업에서 어떻게 발현되는지에 대한 보다 심층적인 이해를 가능하게 하며, 이는 원치 않는 부작용을 줄이기 위한 보다 정밀한 개입 전략을 수립하는 데 기여할 수 있습니다. 