# Margin-aware Preference Optimization for Aligning Diffusion Models without Reference
## TL;DR
## Summary
- [https://arxiv.org/pdf/2406.06424.pdf](https://arxiv.org/pdf/2406.06424.pdf)

## 1. 각 섹션의 주요 내용 요약

### 초록

이 논문은 현대의 텍스트-이미지 변환 확산 모델, 특히 Stable Diffusion XL(SDXL)의 정렬 문제를 다룹니다. 기존 방법들이 참조 모델을 기반으로 정규화를 사용하면서 발생하는 "참조 불일치" 문제를 해결하기 위해 MaPO(Margin-aware Preference Optimization)라는 새로운 메모리 친화적 선호 정렬 방법을 제안합니다. 이 방법은 참조 모델에 의존하지 않고 선호 데이터의 확률적 차이를 극대화하는 방식으로 모델을 학습합니다.

### 1. 서론

현대의 정렬 기법들은 주로 인간의 선호도를 반영하려는 목적으로 사용되지만, 참조 모델을 기반으로 한 정규화가 학습의 유연성을 제한합니다. 특히 텍스트-이미지 변환 모델에서 시각적 모달리티의 비구조적 특성 때문에 문제가 더 심각해집니다. 이에 새로운 정렬 방법인 MaPO를 제안하여 이러한 참조 불일치 문제를 해결합니다.

### 2. 본론 - 배경 지식

텍스트-이미지 확산 모델들이 어떻게 작동하는지 설명합니다. 이 모델들은 텍스트 조건부로 이미지 데이터를 점진적으로 정제하는 과정을 거칩니다. 이러한 방식이 어떻게 MaPO 방법론에 적용되는지 소개합니다.

### 3. MaPO 방법론

MaPO는 참조 모델에 의존하지 않고 선택된 스타일과 선호도를 학습합니다. 이는 선택된 이미지와 거부된 이미지 사이의 확률적 차이를 극대화하여 이루어집니다. MaPO의 손실 함수, 경사 하강법 등을 통해 어떻게 모델이 더 효율적으로 학습되는지 설명합니다.

### 4. 실험

세 가지 선호 데이터셋(Pick-Style, Pick-Safety, Pick-a-Pic v2)을 사용하여 MaPO를 평가했습니다. MaPO는 스타일 정렬 평가에서 다른 방법들보다 뛰어난 성능을 보였으며, 메모리 사용량과 학습 시간 측면에서도 효율적입니다.

### 5. 결론

MaPO는 참조 모델 없이 텍스트-이미지 확산 모델을 선호 데이터에 맞게 정렬하는 새로운 방법입니다. 이 방법은 참조 모델로 인한 제한을 극복하고, 다양한 데이터셋에서 우수한 성능을 보였습니다. 이로써 MaPO는 데이터와 메모리 효율적인 정렬 방법으로 자리매김합니다.

## 2. 논문의 전체 요약

이 논문은 현대 텍스트-이미지 변환 모델에서의 참조 불일치 문제를 해결하기 위해 MaPO라는 새로운 방법을 제안합니다. MaPO는 참조 모델에 의존하지 않고 선택된 스타일과 선호도를 학습하여 모델을 정렬합니다. 이를 통해 기존 방법들이 직면한 유연성 제한 문제를 극복하였으며, 세 가지 데이터셋에서 우수한 성능을 입증하였습니다.

MaPO는 모델이 선택된 이미지와 거부된 이미지 사이의 확률적 차이를 극대화하게 하여 더 정확하고 사용자 선호에 맞는 이미지를 생성할 수 있게 합니다. 이는 특히 스타일과 안전성에 집중된 새 데이터셋(Pick-Style, Pick-Safety)에서 뛰어난 성능을 보였으며, 나아가 메모리 사용량과 학습 시간 측면에서도 효율적입니다. 

이 논문의 핵심 기여는 참조 불일치 문제를 극복하는 새로운 정렬 방법을 제안하고 이를 실험적으로 검증한 것입니다. MaPO는 다양한 스타일과 일반적인 사용자 선호도에 맞춘 이미지 생성을 돕는 혁신적인 방법이 될 것입니다.