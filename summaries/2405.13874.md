# Affine-based Deformable Attention and Selective Fusion for Semi-dense Matching
## TL;DR
## Summary
- [https://arxiv.org/pdf/2405.13874.pdf](https://arxiv.org/pdf/2405.13874.pdf)

### 섹션별 요약

#### 1. 소개

이미지 매칭은 많은 컴퓨터 비전 작업의 핵심 요소입니다. 전통적으로 키포인트 추출, 특징 설명, 특징 매칭의 단계를 거칩니다. 최근에는 Transformer를 활용한 통합된 학습 기반 방법이 도입되어, 더 정밀하고 효율적인 이미지 매칭이 가능해졌습니다. Transformer 기반 매칭에서 중요한 문제는 토큰의 세밀함과 계산 효율성의 균형을 맞추는 것입니다. 현재 방법들은 전역-로컬 주의 메커니즘을 사용하여 전역적으로는 큰 범위의 종속성을, 로컬에서는 세밀한 정보를 처리합니다. 하지만 기존 방법은 로컬 변형을 고려하지 않아 한계가 있습니다.

#### 2. 관련 연구

**2.1 전역-로컬 주의 메커니즘**:
Transformer를 활용한 방법들은 높은 계산 복잡성을 해결하기 위해 전역 주의와 로컬 주의를 결합한 프레임워크를 제안했습니다. 전역 주의는 넓은 범위의 종속성을 모델링하고, 로컬 주의는 세밀한 정보를 처리합니다.

**2.2 변형 가능한 주의**:
Vision Transformer에서 변형 가능한 주의는 로컬 특징에 기반한 동적 샘플링을 통해 주의 범위를 조정합니다. 기존 방법은 자유 형식의 변형을 학습하는 반면, 우리는 기하학적 근거에 기반한 변형을 제안합니다.

**2.3 로컬 변형 추정**:
기존의 단일 뷰 기반 특징 기술과 달리, 우리는 로컬 형상 추정을 크로스 뷰 주의 프레임워크에 통합합니다.

#### 3. 방법론

**3.1 전역 주의**:
전역 주의는 1/32 해상도에서 진행되며, 입력 특징 맵을 다운샘플링하여 주의 매트릭스를 계산하고, 이를 다시 업샘플링하여 원본 특징 맵과 결합합니다.

**3.2 로컬 변형 가능한 주의**:
로컬 변형을 반영하기 위해 중간 변형 필드를 추정하고, 이를 통해 로컬 주의의 초점을 맞춥니다. 로컬 주의는 불확실성에 기반하여 전역 메시지와 결합됩니다.

**3.3 선택적 메시지 결합**:
불확실성을 기반으로 전역 메시지와 로컬 메시지를 가중합하여 결합합니다.

**3.4 매칭 결정**:
강화된 특징을 사용하여 상호 최근접 이웃과 듀얼 소프트맥스 점수를 통해 최종 매칭을 결정합니다.

**3.5 손실 공식화**:
손실 함수는 세 가지 부분으로 구성됩니다: 거친 수준 손실, 세밀한 수준 손실, 흐름 추정 손실. 추가적으로 공간 소프트맥스 손실을 도입하여 공간적 부드러움을 보장합니다.

#### 4. 실험

**4.1 두 뷰 포즈 추정**:
ScanNet과 MegaDepth 데이터셋을 사용하여 제안된 방법의 매칭 능력을 평가했습니다. 제안된 방법은 기존의 희소 및 반밀집 방법들보다 뛰어난 성능을 보였습니다.

**4.2 시각적 로컬라이제이션**:
InLoc과 Aachen Day-Night 데이터셋을 사용하여 시각적 로컬라이제이션에서의 성능을 평가했습니다. 제안된 방법은 가장 높은 정확도를 기록했습니다.

**4.3 소요비용 평가**:
다양한 비용 제약 하에서 제안된 방법의 효율성을 평가했습니다. 제안된 방법은 유사한 비용에서 더 나은 성능을 보였습니다.

### 전체 요약

본 논문에서는 AffineFormer라는 새로운 반밀집 매칭 방법을 소개합니다. 이 방법은 기하학적 변형을 반영한 로컬 주의와 선택적 메시지 결합을 통해 이미지 간 정확하고 강인한 대응을 찾습니다. 공간 소프트맥스 손실을 추가하여 공간적 부드러움을 보장하고, 다양한 실험을 통해 제안된 방법의 우수성을 입증하였습니다. 제안된 네트워크는 기존의 방법들보다 높은 성능을 제공하며, 계산 비용과 모델 크기 측면에서도 효율적입니다.