# Deploying a Retrieval based Response Model for Task Oriented Dialogues
## TL;DR
## Summary
- [https://arxiv.org/pdf/2210.14379.pdf](https://arxiv.org/pdf/2210.14379.pdf)

## (1) 섹션 요약

### Abstract
이 논문은 온라인 소매점을 위한 작업 지향형 대화 시스템을 설명합니다. 주로 높은 대화 능력과 적응력을 갖추며, 비즈니스 제약을 준수하는 시스템을 목표로 합니다. 제안된 방법은 무표시 대화 데이터를 이용해 대화 템플릿을 생성하고, 이를 통해 대화 모델을 학습시킵니다. 또한, 모델의 성능을 향상시키는 자기 지도 학습과 제한된 데이터에서의 감독 학습을 결합한 학습 전략을 제안합니다.

### Introduction
작업 지향형 대화 시스템(TOD)은 호텔 예약, 비행기 예약, 고객 지원 등 특정 작업을 수행하기 위한 대화 시스템입니다. 이 논문에서는 대규모 대화 템플릿을 생성하고 이를 활용하여 온라인 소매점의 고객 상담을 도와주는 대화 모델을 제작하는 방법을 설명합니다. 제안된 모델은 Poly-Encoder를 기반으로 향상된 구조를 가지며, 자체 지도 학습과 감독 학습을 결합한 학습 방법을 사용합니다.

### Related Work
작업 지향형 대화 시스템에서는 컨텍스트와 응답의 유사도를 계산하여 적절한 응답을 선택하는 방법이 주로 사용됩니다. 해당 분야에서 많이 사용되는 모델 구조는 Cross-encoders와 Bi-encoders가 있습니다. Cross-encoders는 입력과 응답 후보에 대해 전체 셀프 어텐션을 수행하는 반면, Bi-encoders는 각 입력과 후보를 개별적으로 인코딩하고 마지막에 결합합니다. 최근에는 Poly-encoders가 주목받고 있으며, 이는 두 구조의 장점을 결합하여 성능을 향상시킬 수 있습니다.

### Response Pool Creation
이 논문에서는 비구조화된 대화 데이터를 이용하여 대규모 대화 템플릿 풀을 생성하는 방법을 설명합니다. 이를 위해 자주 사용되는 문장들을 먼저 선택하고, 기존에 선택된 응답과 정보가 중복되지 않는 문장들을 추가로 선택합니다. 또한, 템플릿에는 메타데이터를 첨부하여 비즈니스 규칙을 준수하도록 했습니다.

### Model Architecture
본 논문에서 제안된 모델 구조는 Poly-Encoder를 기반으로 하여 대화 히스토리, 응답 후보, 프로필 피처를 인코딩합니다. 자사 모델은 각 입력을 별도의 Transformer를 사용하여 인코딩하고, 셀프 어텐션과 크로스 어텐션 레이어를 적용하여 입력 간의 상호작용을 학습합니다. 이후 MLP를 활용하여 최종 점수를 계산하고, 이를 통해 응답 순위를 매깁니다.

### Model Development
고객 경험과 신뢰를 보호하기 위해 단순히 인공지능 모델을 인간-인간 대화 데이터로 학습시켜 바로 배포하는 것이 아닌, 인간 중재 단계를 도입하여 데이터 수집 및 모델 평가를 병행합니다. 초기 모델은 자기 지도 학습을 통해 학습하고, 이후 감독 학습 단계에서는 인간 중재 환경에서 수집된 데이터를 활용하여 모델을 더욱 향상시킵니다.

### Evaluation
평가는 내부 e커머스 고객 서비스 대화 데이터셋을 사용하여 진행되었습니다. 모델의 성능은 오프라인에서 Recall@k, MRR과 같은 기준으로 평가하고, 온라인에서는 TAR (Turn-level Acceptance Rate), TC (Task Completion), ATC (Automated Task Completion)와 같은 기준으로 평가합니다. 초기 모델은 자기 지도 학습을 통해 성능을 평가하였으며, 감독 학습을 거친 후 성능이 크게 향상됨을 확인할 수 있었습니다.

### Conclusion
이 논문에서는 대화 템플릿을 활용한 작업 지향형 대화 모델을 제안하였습니다. 제안된 모델은 높은 정확도와 실시간 대화 처리 성능을 자랑하며, 제한된 데이터셋에서도 성능을 향상시킬 수 있음을 확인하였습니다. 또한, 인간 중재 기반의 데이터 수집 및 평가 방법을 도입하여 모델을 더욱 발전시키는 데 성공하였습니다.

## (2) 전체 요약
이 연구는 작업 지향형 대화 시스템을 개발하기 위해 대화 템플릿을 활용하는 방법을 제안합니다. 제안된 방법은 대규모의 무표시 대화 데이터를 사용하여 템플릿을 생성하고, 이를 통해 대화 모델을 학습시킵니다. 모델 구조는 Poly-Encoder를 기반으로 하여 대화 히스토리, 응답 후보, 프로필 피처를 인코딩하고, 크로스 어텐션 레이어를 사용하여 입력 간의 상호작용을 학습합니다.

평가는 내부 e커머스 고객 서비스 대화 데이터를 사용하여 진행되었으며, 초기 모델은 자기 지도 학습을 통해 학습되고, 감독 학습을 추가하였습니다. 이를 통해 모델의 성능이 크게 향상됨을 확인할 수 있었습니다. 제안된 모델은 높은 정확도와 실시간 대화 처리 성능을 자랑하며, 대규모 템플릿 풀을 효율적으로 사용하여 다양한 대화 상황에 대처할 수 있습니다.

### 기여 및 혁신
1. **대규모 대화 템플릿 생성:** 무표시 대화 데이터를 이용하여 대규모 대화 템플릿을 생성하는 방법을 제안하였습니다.
2. **향상된 모델 구조:** Poly-Encoder 기반의 모델 구조를 제안하여 대화 히스토리와 응답 후보 간의 상호작용을 효율적으로 학습합니다.
3. **혼합 학습 전략:** 자기 지도 학습과 감독 학습을 결합하여 모델의 성능을 향상시키는 방법을 제안하였습니다.
4. **실시간 대화 처리:** 제안된 모델은 높은 정확도와 실시간 대화 처리 성능을 자랑하며, 비즈니스 규칙을 준수합니다.