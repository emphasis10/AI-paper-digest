# ZeroComp: Zero-shot Object Compositing from Image Intrinsics via Diffusion
## TL;DR
## Summary
- [https://arxiv.org/pdf/2410.08168.pdf](https://arxiv.org/pdf/2410.08168.pdf)

**논문 요약: ZEROCOMP**

이 논문에서는 고품질의 사진 합성을 위한 새로운 AI 기법 **ZEROCOMP**을 제안합니다. ZEROCOMP은 사전에 훈련된 데이터 없이, 이미지 속에 3D 객체를 현실감 있게 삽입하여 그려낼 수 있는 "제로샷" 합성 기술입니다. 이 기술은 복잡한 조명과 그림자를 자동으로 생성하며, 사전의 장면 또는 조명 데이터 없이도 다양한 배경에 가상 객체를 자연스럽게 삽입합니다.

---

### 1. 서론
사진 속 3D 객체 합성은 영화나 그래픽 작업에서 중요한 역할을 합니다. 기존의 이미지 기반 조명(Illuminance-Based Lighting) 방법은 조명과 그림자를 수동으로 조정해 사진에 객체를 삽입했으나, 이 과정이 복잡하고 시간 소모적입니다. 최근에는 **Stable Diffusion**과 같은 확산 모델을 활용해 이러한 작업을 자동화하려는 시도가 있었지만, 객체의 형태나 자세가 잘못 표현되는 등의 문제가 발생했습니다. 이에 대한 대안으로 ZEROCOMP은 확산 모델과 ControlNet을 결합해 더욱 정교한 합성을 목표로 합니다.

---

### 2. 관련 연구
기존 연구들은 크게 **조명 추정**, **내재적 이미지 분해(intrinsic image decomposition)**, **그림자 생성**, 그리고 **색 조화(harmonization)** 네 가지 방향으로 나뉩니다. 
1. **조명 추정**: 고해상도의 조명 환경을 예측하여 3D 객체에 적합한 조명 효과를 부여합니다.
2. **내재적 이미지 분해**: 이미지의 알베도(표면 반사도), 깊이, 표면 법선(normal map)을 추출하여 객체의 조명과 그림자를 조정합니다.
3. **그림자 생성**: 사진 속에 삽입된 객체에 맞춰 사실적인 그림자를 생성합니다.
4. **색 조화**: 삽입된 객체의 색상 조정을 통해 배경과 자연스럽게 융화되도록 합니다.

---

### 3. ZEROCOMP 모델 개요
ZEROCOMP은 **Stable Diffusion**과 **ControlNet**의 결합으로, 장면의 깊이, 표면 법선, 알베도 정보를 이용해 객체가 삽입된 이미지에 맞는 조명과 그림자를 생성합니다. 이 모델은 특정 장면에서 훈련되지 않고도 다양한 배경에 객체를 자연스럽게 합성할 수 있는 제로샷 기능을 제공합니다. 특히 장면의 조명과 기하 구조에 대한 내재적 이해를 바탕으로, 삽입된 객체가 실제 환경과 조화를 이루도록 합니다.

---

### 4. ZEROCOMP 훈련
ZEROCOMP는 **OpenRooms**와 **InteriorVerse**와 같은 데이터셋을 활용해 이미지의 깊이, 표면 법선, 알베도 정보 등을 학습합니다. 훈련 과정에서는 이미지의 일부 조명 정보를 제거하여 모델이 조명과 기하 구조를 추론하도록 합니다. 또한, 특수한 손실 함수 설계를 통해 객체의 색상과 장면의 색상이 자연스럽게 일치하도록 학습합니다.

---

### 5. 제로샷 객체 합성
훈련된 ZEROCOMP는 ZoeDepth, StableNormal과 같은 기존 모델을 통해 배경 사진의 깊이, 법선, 알베도 지도를 추출한 후 이를 합성하여 최종 이미지를 생성합니다. 객체가 배경의 조명과 그림자와 일치하도록 조정하며, 이렇게 생성된 이미지는 매우 사실적입니다.

---

### 6. 배경 유지 보정
ControlNet이 배경 이미지의 세부 사항을 완벽히 재현하지 못할 수 있어, ZEROCOMP는 배경 이미지와 합성 이미지의 차이점을 줄이기 위해 차별적 합성 기법을 사용합니다. 이 기법을 통해 합성된 이미지가 원래의 배경과 일관성을 유지하도록 합니다.

---

### 7. 평가 및 사용자 연구
ZEROCOMP는 새로운 3D 객체 합성 평가 데이터셋을 구축하여 다양한 지표로 성능을 측정하였습니다. 주요 평가 지표로는 PSNR, SSIM, LPIPS 등이 사용되었으며, 사용자 연구를 통해 현실감이 높은 결과를 확인하였습니다. 결과적으로, ZEROCOMP는 조명 추정 방식과 비교해 더 높은 사용자 혼동률을 보이며, 사용자들이 더욱 사실적으로 인식하는 것으로 나타났습니다.

---

### 8. 확장성
ZEROCOMP는 추가적인 조명과 재질 정보를 활용하여 객체의 표면 반사율이나 금속성을 조절하는 등의 확장성을 가지고 있습니다. 또한 실외 장면이나 2D 객체에도 적용할 수 있어 다양한 합성 환경에서 유연하게 활용할 수 있습니다.

---

### 9. 결론
ZEROCOMP는 3D 객체 합성에 있어 사실적이고 일관된 조명과 그림자 효과를 제공하며, 제로샷 합성을 통해 더욱 다양한 장면에 적용될 수 있는 잠재력을 가지고 있습니다. 이 연구는 향후 비슷한 합성 작업에 있어 중요한 참고자료가 될 것으로 기대됩니다.