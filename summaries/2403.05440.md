# Is Cosine-Similarity of Embeddings Really About Similarity?
## TL;DR
## Summary
- [https://arxiv.org/pdf/2403.05440.pdf](https://arxiv.org/pdf/2403.05440.pdf)

### 1. 서론 (Introduction)
논문의 서론에서는 코사인 유사성(cosine similarity)이 고차원 객체 간의 의미적 유사성을 측정하는 데 사용된다고 설명합니다. 코사인 유사성은 벡터 간의 각도의 코사인 값으로, 벡터의 크기보다는 방향의 일치성을 강조합니다. 그러나 코사인 유사성이 항상 효과적인 것은 아니며, 종종 정규화되지 않은 내적(dot-product)보다 성능이 떨어지는 경우가 있습니다. 본 논문은 이러한 관찰에 대한 이론적 통찰을 제공하기 위해, 선형 모델에서 도출된 임베딩을 분석합니다. 이를 통해 코사인 유사성이 임의의, 따라서 무의미한 유사성을 생성할 수 있음을 보여줍니다.

### 2. 행렬 분해 모델 (Matrix Factorization Models)
논문에서는 선형 모델을 중심으로 행렬 분해(matrix factorization) 모델을 사용하여 코사인 유사성의 한계를 이론적으로 분석합니다. 행렬 분해 모델은 데이터 포인트와 특징을 포함하는 행렬을 저차원 임베딩으로 근사화하는 기법입니다. 이 모델은 사용자와 아이템 간의 내적을 기반으로 하여 임베딩을 학습합니다. 학습된 임베딩 간의 코사인 유사성은 때때로 임의의 결과를 초래할 수 있습니다.

### 3. 학습 (Training)
코사인 유사성의 유용성에 영향을 미치는 중요한 요소는 임베딩을 학습할 때 사용되는 정규화 방식입니다. 논문에서는 두 가지 일반적인 정규화 방식을 다룹니다:
- 첫 번째 방식: 임베딩의 곱에 대해 정규화
- 두 번째 방식: 각 행렬을 개별적으로 정규화
첫 번째 방식은 임베딩 벡터의 축적에 대한 자유도를 가지므로, 학습된 임베딩 벡터의 크기에 영향을 미칠 수 있습니다. 두 번째 방식은 유일한 해를 제공하여 코사인 유사성의 결과를 보다 일관되게 만듭니다.

### 4. 첫 번째 목표의 세부 사항 (Details on First Objective)
첫 번째 정규화 방식의 경우, 임의의 대각 행렬 \(D\)를 도입하여 다양한 코사인 유사성을 얻을 수 있습니다. 이는 코사인 유사성이 학습된 임베딩의 방향보다는 크기에 따라 크게 변할 수 있음을 의미합니다. 예를 들어, 행렬 \(D\)의 선택에 따라 두 아이템 간의 코사인 유사성이 크게 달라질 수 있습니다.

### 5. 두 번째 목표의 세부 사항 (Details on Second Objective)
두 번째 정규화 방식에서는 각 행렬을 개별적으로 정규화하므로, 유일한 해를 제공합니다. 이 방식에서는 코사인 유사성이 임의적이지 않으며, 일관된 결과를 제공합니다. 그러나 이러한 유일한 해가 실제로 가장 좋은 의미적 유사성을 제공하는지는 여전히 미지수입니다.

### 6. 코사인 유사성의 대안 및 해결책 (Remedies and Alternatives to Cosine-Similarity)
논문에서는 코사인 유사성의 문제를 해결하기 위한 몇 가지 대안을 제안합니다. 하나는 코사인 유사성을 기준으로 모델을 학습하는 것이며, 또 다른 방법은 임베딩 공간을 회피하고 원래 데이터 공간에서 유사성을 계산하는 것입니다. 또한, 학습 중 또는 학습 전에 정규화를 적용하여 의미적 유사성을 개선할 수 있음을 강조합니다.

### 7. 실험 (Experiments)
논문에서는 시뮬레이션 데이터를 사용하여 코사인 유사성이 아이템 클러스터 구조를 얼마나 잘 복원하는지 실험을 통해 분석합니다. 실험 결과, 첫 번째 정규화 방식에서는 다양한 코사인 유사성을 얻을 수 있으며, 두 번째 방식에서는 일관된 결과를 얻을 수 있음을 확인하였습니다.

## 전체 요약
이 논문은 코사인 유사성이 고차원 객체 간의 의미적 유사성을 측정하는 데 사용될 때 발생할 수 있는 문제점을 다룹니다. 특히, 선형 모델에서 도출된 임베딩을 분석하여 코사인 유사성이 임의적이고 때로는 무의미한 결과를 초래할 수 있음을 이론적으로 입증합니다. 이를 해결하기 위해, 정규화 방식을 개선하거나 원래 데이터 공간에서 유사성을 계산하는 방법 등을 제안합니다. 이 논문의 연구 결과는 코사인 유사성을 사용할 때 주의가 필요하며, 적절한 대안을 고려해야 함을 시사합니다.